import os
import sys
import urllib.request
import datetime
import time
import json
import pandas as pd

ServiceKey = "64517a4864726277353076526d6457"

#[CODE 1]
def getRequestUrl(url):
    req = urllib.request.Request(url)
    try:
        response = urllib.request.urlopen(req)
        if response.getcode() == 200:
            print("[%s] Url Request Success" % datetime.datetime.now())
            return response.read().decode('utf-8')
    except Exception as e:
        print(e)
        print("[%s] Error for URL : %s" % (datetime.datetime.now(), url))
        return None
    
#[CODE 2]
def getPage(type, start_index, end_index):
    service_url = "http://openAPI.seoul.go.kr:8088/"
    
    parameters = ServiceKey
    parameters += "/" + type
    parameters += "ChunmanFreeSuggestions/"
    parameters += "/" + start_index
    parameters += "/" + end_index 
    url = service_url + parameters
    print(url)
    retData = getRequestUrl(url) #[CODE 1]

    if (retData == None):
        return None
    else:
        return json.loads(retData)

#[CODE 3]    
def getItemAll(type, start_index, end_index):
    jsonResult = []
    result = []

    jsonData = getPage(type, start_index, end_index)
    

def main():
    jsonResult = []
    result = []

    print("<< 상상대로 서울 자유제안 정보 데이터를 수집합니다 >>")
    type = input('어떤 형태의 파일 타입으로 가져올까요?(xml: xml / xml파일: xmlf / 엑셀파일: xls / json파일: json) :')
    start_index = int(input('수집을 시작하려는 페이지 번호를 입력해 주세요 : '))
    end_index = int(input('수집을 끝내려는 페이지 번호를 입력해 주세요 : '))




if __name__ == '__main__':
    main()