import os
import sys
import urllib.request
import datetime
import time
import json
import pandas as pd

ServiceKey = "64517a4864726277353076526d6457"

#[CODE 1]
def getRequestUrl(url):
    req = urllib.request.Request(url)
    try:
        response = urllib.request.urlopen(req)
        if response.getcode() == 200:
            print("[%s] Url Request Success" % datetime.datetime.now())
            return response.read().decode('utf-8')
    except Exception as e:
        print(e)
        print("[%s] Error for URL : %s" % (datetime.datetime.now(), url))
        return None
    
#[CODE 2]
def getPage(yyyymm, national_code, ed_cd):
    service_url = "http://openAPI.seoul.go.kr:8088/"
    
    parameters = ServiceKey #인증키
    parameters += "&YM=" + yyyymm
    parameters += "&NAT_CD=" + national_code
    parameters += "&ED_CD=" + ed_cd
    url = service_url + parameters
    print(url) #액세스 거부 여부 확인용 출력
    retData = getRequestUrl(url) #[CODE 1]

    if (retData == None):
        return None
    else:
        return json.loads(retData)


if __name__ == '__main__':
    main()